<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
  </head>
  <body>
    <canvas width="1000" height="1000" style="width: 500px; height: 500px;" id="chart"></canvas>
    <script>
      const canvas = document.getElementById('chart');
      const ctx = canvas.getContext('2d');

      function renderChart(stage) {
        ctx.setTransform(2, 0, 0, 2, 0, 0);
        ctx.clearRect(0, 0, 500, 500);

        // Render the labels
        ctx.font = '16px sans-serif';
        ctx.textBaseline = 'bottom';
        ctx.textAlign = 'left';

        ctx.fillStyle = ctx.strokeStyle = 'rgba(200, 200, 200, 1)';
        const labelStage = Math.abs(stage * 2 - 1);
        for (let i = 0; i <= 5; ++i) {
          const y = 475 - i * 450 / 5 * (labelStage * 0.7 + 0.3);
          ctx.fillText(i * 100, 10, y);
          ctx.lineWidth = 1;
          ctx.beginPath();
          ctx.moveTo(0, y);
          ctx.lineTo(1000, y);
          ctx.stroke();
          ctx.closePath();
        }

        if (labelStage > 0.4) {
          const opacity = Math.min(1, (labelStage - 0.4) / 0.2);
          ctx.fillStyle = ctx.strokeStyle = `rgba(200, 200, 200, ${opacity})`;
          for (let i = 0.5; i < 5; ++i) {
            const y = 475 - i * 450 / 5 * (labelStage * 0.7 + 0.3);
            ctx.fillText(i * 100, 10, y);
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, y);
            ctx.lineTo(1000, y);
            ctx.stroke();
            ctx.closePath();
          }
        }

        // Render the lines
        ctx.strokeStyle = 'red';
        ctx.lineWidth = 2;
        ctx.beginPath();
        for (let i = 0; i <= 40; ++i) {
          const x = i * 12.5;
          const y = 250 + Math.sin((i / 20 + stage) * 2 * Math.PI) * 200;

          if (i === 0) {
            ctx.moveTo(x, y);
          } else {
            ctx.lineTo(x, y);
          }
        }
        ctx.stroke();
        ctx.closePath();

        ctx.strokeStyle = 'green';
        ctx.lineWidth = 2;
        ctx.beginPath();
        for (let i = 0; i <= 40; ++i) {
          const x = i * 12.5;
          const y = 250 + Math.sin((i / 20 + stage + 0.3) * 2 * Math.PI) * 200;

          if (i === 0) {
            ctx.moveTo(x, y);
          } else {
            ctx.lineTo(x, y);
          }
        }
        ctx.stroke();
        ctx.closePath();

        // Render the top fade
        const fade = ctx.createLinearGradient(0, 0, 0, 75);
        fade.addColorStop(0, 'rgba(255, 255, 255, 1)');
        fade.addColorStop(1, 'rgba(255, 255, 255, 0)');
        ctx.fillStyle = fade;
        ctx.fillRect(0, 0, 500, 75);
      }

      const startTime = Date.now();

      (function handleFrame() {
        renderChart((Date.now() - startTime) / 2000 % 1);
        requestAnimationFrame(handleFrame);
      })();
    </script>
  </body>
</html>
